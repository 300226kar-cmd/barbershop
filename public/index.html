<!DOCTYPE html>
<html lang="hy">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Barbershop</title>
<link rel="stylesheet" href="tun.css">

</head>

<body>

<header>CHRENC BARBERSHOP</header>


<button id="bookBtn">üìÖ ’ä’°’ø’æ’´÷Ä’•’¨</button>

<div id="bookingModal">
<label>‘±’∂’∏÷Ç’∂</label><input type="text" id="nameInput" placeholder="’ï÷Ä’´’∂’°’Ø’ù ‘±÷Ä’¥’°’∂"/>
<label>’Ä’•’º’°’≠’∏’Ω</label><input type="text" id="phoneInput" placeholder="’ï÷Ä’´’∂’°’Ø’ù 077123456"/>
<label>’ï÷Ä</label><select id="daySelect"></select>
<label>‘∫’°’¥</label><select id="timeSelect"></select>
<div class="modal-buttons">
<button id="confirmBooking">’Ä’°’Ω’ø’°’ø’•’¨</button>
<button id="closeModal">’ì’°’Ø’•’¨</button>
</div>
<div id="statusMsg" class="alert"></div>
</div>


<div class="hero">
’Ñ’•÷Ä ’ç’°’∂÷Ä’æ’°’Æ÷Ñ’∂’•÷Ä’®
</div>

<section class="section">
<h2>‘æ’°’º’°’µ’∏÷Ç’©’µ’∏÷Ç’∂’∂’•÷Ä</h2>

<div class="grid">

<div class="card">
<img src="https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=800&auto=format&fit=crop">
<h3>’è’≤’°’¥’°÷Ä’§’∏÷Ç ’Ω’°’∂÷Ä’æ’°’Æ÷Ñ</h3>
<p>‘∫’°’¥’°’∂’°’Ø’°’Ø’´÷Å ’∏’≥</p>
<p><strong>3000 ÷è</strong></p>

</div>

<div class="card">
<img src="https://images.unsplash.com/photo-1599351431202-1e0f0137899a?w=800&auto=format&fit=crop">
<h3>’Ñ’∏÷Ä’∏÷Ç÷Ñ</h3>
<p>’Ñ’∏’§’•’¨’°’æ’∏÷Ä’∏÷Ç’¥</p>
<p><strong>2000 ÷è</strong></p>

</div>

<div class="card">
<img src="https://images.unsplash.com/photo-1585747860715-2ba37e788b70?w=800&auto=format&fit=crop">
<h3>VIP ’ì’°’©’•’©</h3>
<p>‘º’´’°÷Ä’™’•÷Ñ ’≠’∂’°’¥÷Ñ</p>
<p><strong>5000 ÷è</strong></p>
</div>

</div>
</section>

<footer>
¬© 2026 Barbershop
</footer>

<!-- Lightbox -->

<div id="lightbox" onclick="closeImage()">
<img id="lightbox-img">
</div>

<script>
const API_URL = "/api";
const bookBtn=document.getElementById("bookBtn");
const modal=document.getElementById("bookingModal");
const closeModal=document.getElementById("closeModal");
const daySelect=document.getElementById("daySelect");
const timeSelect=document.getElementById("timeSelect");
const confirmBooking=document.getElementById("confirmBooking");
const statusMsg=document.getElementById("statusMsg");
const nameInput=document.getElementById("nameInput");
const phoneInput=document.getElementById("phoneInput");

  let closedWeekdays = [];
let closedDates = [];
function showAlert(message, type) {
  statusMsg.textContent = message;
  statusMsg.className = "alert " + type;
  statusMsg.style.display = "block";

  setTimeout(() => {
    statusMsg.style.display = "none";
  }, 4000);
}
async function loadClosedDays() {
  try {
    const res = await fetch(`${API_URL}/closed-days`);
    const data = await res.json();
    closedWeekdays = data.weekdays || [];
    closedDates = data.dates || [];
  } catch (err) {
    console.error("Closed days error");
  }
}
  
bookBtn.onclick=async()=>{modal.style.display="block";statusMsg.textContent="";loadNextWeekDays();await loadTimesWithAvailability();}
closeModal.onclick=()=>{modal.style.display="none";}
daySelect.onchange=async()=>{await loadTimesWithAvailability();}

async function loadNextWeekDays(){
  await loadClosedDays();

  daySelect.innerHTML="";
  const today=new Date();

  for(let i=0;i<=6;i++){
    let d=new Date();
    d.setDate(today.getDate()+i);

    let value=d.toISOString().split("T")[0];
    let weekday=d.getDay(); // 0-6
    let label=d.toLocaleDateString("hy-AM",{weekday:"long",year:"numeric",month:"long",day:"numeric"});

    let option=document.createElement("option");
    option.value=value;
    option.textContent=label;

    if(closedWeekdays.includes(String(weekday)) || closedDates.includes(value)){
      option.disabled=true;
      option.textContent += " (’ì’°’Ø)";
    }

    daySelect.appendChild(option);
  }
}

function generateAllSlots(){let slots=[],startHour=10,endHour=23;for(let h=startHour;h<endHour;h++){for(let m=0;m<60;m+=30){slots.push(`${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}`);}}return slots;}

async function loadTimesWithAvailability(){
timeSelect.innerHTML="";
const selectedDate=daySelect.value;
const allSlots=generateAllSlots();
try{const res=await fetch(`${API_URL}/bookings?date=${selectedDate}`);const bookedTimes=await res.json();
allSlots.forEach(slot=>{const option=document.createElement("option");option.value=slot;if(bookedTimes.includes(slot)){option.textContent=`${slot} (’¶’¢’°’≤’æ’°’Æ)`;option.disabled=true;}else{option.textContent=slot;}timeSelect.appendChild(option);});
}catch(err){showAlert("‚ùå " + data.message, "error");}
}

confirmBooking.onclick = async () => {
  const name = nameInput.value.trim();
  const phone = phoneInput.value.trim();
  const date = daySelect.value;
  const time = timeSelect.value;

  if (!name || !phone) {
    showAlert("‚ùå ‘º÷Ä’°÷Å÷Ä’•÷Ñ ’¢’∏’¨’∏÷Ä ’§’°’∑’ø’•÷Ä’®", "error");
    return;
  }

  showAlert("‚è≥ ’à÷Ç’≤’°÷Ä’Ø’æ’∏÷Ç’¥ ’ß...", "success");

  try {
    const res = await fetch(`${API_URL}/book`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, phone, date, time })
    });

    const data = await res.json();

    if (res.ok) {
      showAlert("‚úÖ ’ä’°’ø’æ’•÷Ä’® ’∞’°’ª’∏’≤’∏÷Ç’©’µ’°’¥’¢ ’£÷Ä’°’∂÷Å’æ’•÷Å", "success");
      await loadTimesWithAvailability();
    } else {
      showAlert("‚ùå " + data.message, "error");
    }

  } catch (err) {
    showAlert("‚ùå ’ç’•÷Ä’æ’•÷Ä’´ ’≠’∂’§’´÷Ä", "error");
  }
};
</script>


</body>
</html>







